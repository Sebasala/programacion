---
import FormattedDate from "../components/FormattedDate.astro";
import { BASE_URL } from "../consts";
import BaseLayout from "@layouts/BaseLayout.astro";
import LinkedInShare from "@components/LinkedInShare.astro";

const {
	blogPath,
	description,
	headerText,
	heroImage,
	pubDate,
	title,
	updatedDate,
	slug,
} = Astro.props;

const domain = Astro.site;

const articleUrl = `${domain}${blogPath}/${slug}/`;
const articleSource = "shan.lat";
---

<BaseLayout
	blogPath={blogPath}
	description={description}
	headerText={headerText}
	image={heroImage}
	title={title}
	withHeader
>
	<main>
		<div class="share">
			<p class="label">Comparte:</p>
			<LinkedInShare
				articleSource={articleSource}
				articleUrl={articleUrl}
				description={description}
				title={title}
			/>
		</div>
		<article>
			<div class="hero-image">
				{
					heroImage && (
						<img
							width={1020}
							height={510}
							src={`${BASE_URL}${heroImage}`}
							alt=""
						/>
					)
				}
			</div>
			<section class="text">
				<div class="title">
					<p class="date">
						<FormattedDate date={pubDate} />
						{
							updatedDate && (
								<div class="last-updated-on">
									Last updated on <FormattedDate date={updatedDate} />
								</div>
							)
						}
					</p>
					<h1 class="post-title">{title}</h1>
				</div>
				<slot />
			</section>
		</article>
	</main>
</BaseLayout>
<style>
	.share {
		align-items: end;
		background-image: linear-gradient(
			0deg,
			rgba(100%, 100%, 100%, 0) 0%,
			var(--light-background) 100%
		);
		display: flex;
		flex-flow: column nowrap;
		padding: calc(var(--space) / 2);
		position: sticky;
		top: 0;
		z-index: 1;
	}
	.date,
	.label {
		margin: 0;
	}

	.label {
		backdrop-filter: blur(5px);
		border-radius: calc(var(--space) / 2);
		padding-left: calc(var(--space) / 2);
	}
	.hero-image img {
		max-height: 300px;
		margin: 0 auto;
		width: auto;
		border-radius: calc(4 * var(--space));
	}
	.title {
		position: relative;
		background-image: linear-gradient(
			180deg,
			rgba(100%, 100%, 100%, 0) 0%,
			var(--light-background) 100%
		);
		padding-top: calc(2 * var(--space));
	}
	.date {
		text-align: center;
	}
	.text {
		margin-top: calc(-7 * var(--space));
	}
</style>
